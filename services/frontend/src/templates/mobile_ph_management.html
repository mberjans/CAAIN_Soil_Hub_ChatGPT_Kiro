<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pH Management - AFAS Mobile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .mobile-container {
            max-width: 100%;
            margin: 0 auto;
            background: #f8f9fa;
            min-height: 100vh;
        }
        
        .header-section {
            background: linear-gradient(135deg, #2c5530 0%, #4a7c59 100%);
            color: white;
            padding: 1rem;
            text-align: center;
        }
        
        .ph-card {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            margin: 0.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid #28a745;
        }
        
        .ph-critical {
            border-left-color: #dc3545;
        }
        
        .ph-warning {
            border-left-color: #ffc107;
        }
        
        .ph-good {
            border-left-color: #28a745;
        }
        
        .ph-meter {
            background: linear-gradient(to right, 
                #dc3545 0%, #dc3545 20%,
                #ffc107 20%, #ffc107 40%,
                #fd7e14 40%, #fd7e14 60%,
                #28a745 60%, #28a745 80%,
                #17a2b8 80%, #17a2b8 100%);
            height: 20px;
            border-radius: 10px;
            position: relative;
            margin: 1rem 0;
        }
        
        .ph-indicator {
            position: absolute;
            top: -5px;
            width: 4px;
            height: 30px;
            background: #000;
            border-radius: 2px;
        }
        
        .quick-action-btn {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.75rem;
            margin: 0.25rem;
            width: 100%;
            font-size: 0.9rem;
        }
        
        .quick-action-btn:hover {
            background: #218838;
            color: white;
        }
        
        .status-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .status-critical {
            background: #dc3545;
            color: white;
        }
        
        .status-warning {
            background: #ffc107;
            color: #000;
        }
        
        .status-good {
            background: #28a745;
            color: white;
        }
        
        .input-group-mobile {
            margin-bottom: 1rem;
        }
        
        .input-group-mobile label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.25rem;
            display: block;
        }
        
        .input-group-mobile input,
        .input-group-mobile select {
            border-radius: 8px;
            border: 1px solid #ced4da;
            padding: 0.75rem;
        }
        
        .tab-content {
            padding: 1rem 0;
        }
        
        .nav-tabs .nav-link {
            border-radius: 8px 8px 0 0;
            margin-right: 0.25rem;
        }
        
        .nav-tabs .nav-link.active {
            background: #28a745;
            border-color: #28a745;
            color: white;
        }
        
        .lime-recommendation {
            background: #e8f5e8;
            border: 1px solid #28a745;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
        }
        
        .trend-chart {
            height: 200px;
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border: 1px solid #dee2e6;
        }
        
        .alert-item {
            background: white;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 0 8px 8px 0;
        }
        
        .gps-info {
            background: #e3f2fd;
            border-radius: 8px;
            padding: 0.5rem;
            margin: 0.5rem 0;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
    <div class="mobile-container">
        <!-- Header -->
        <div class="header-section">
            <h4><i class="fas fa-vial"></i> pH Management</h4>
            <p class="mb-0">Monitor and manage soil pH levels</p>
        </div>

        <!-- Navigation Tabs -->
        <div class="container-fluid p-2">
            <ul class="nav nav-tabs" id="phTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" 
                            data-bs-target="#dashboard" type="button" role="tab">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="test-tab" data-bs-toggle="tab" 
                            data-bs-target="#test" type="button" role="tab">
                        <i class="fas fa-plus"></i> Test
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="lime-tab" data-bs-toggle="tab" 
                            data-bs-target="#lime" type="button" role="tab">
                        <i class="fas fa-calculator"></i> Lime
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="monitor-tab" data-bs-toggle="tab" 
                            data-bs-target="#monitor" type="button" role="tab">
                        <i class="fas fa-chart-line"></i> Monitor
                    </button>
                </li>
            </ul>

            <div class="tab-content" id="phTabContent">
                <!-- Dashboard Tab -->
                <div class="tab-pane fade show active" id="dashboard" role="tabpanel">
                    <!-- Field Status Cards -->
                    <div class="ph-card ph-warning">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">North Field</h6>
                                <p class="mb-1">pH: 5.8 <span class="status-badge status-warning">Needs Lime</span></p>
                                <small class="text-muted">Last tested: Mar 15, 2024</small>
                            </div>
                            <div class="text-end">
                                <i class="fas fa-exclamation-triangle text-warning fa-2x"></i>
                            </div>
                        </div>
                        <div class="ph-meter">
                            <div class="ph-indicator" style="left: 25%;"></div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <button class="quick-action-btn btn-warning">
                                    <i class="fas fa-plus"></i> Add Lime
                                </button>
                            </div>
                            <div class="col-6">
                                <button class="quick-action-btn btn-info">
                                    <i class="fas fa-vial"></i> Retest
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="ph-card ph-good">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">South Field</h6>
                                <p class="mb-1">pH: 6.5 <span class="status-badge status-good">Optimal</span></p>
                                <small class="text-muted">Last tested: Feb 28, 2024</small>
                            </div>
                            <div class="text-end">
                                <i class="fas fa-check-circle text-success fa-2x"></i>
                            </div>
                        </div>
                        <div class="ph-meter">
                            <div class="ph-indicator" style="left: 65%;"></div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <button class="quick-action-btn">
                                    <i class="fas fa-calendar"></i> Schedule Next Test
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="ph-card ph-critical">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">East Field</h6>
                                <p class="mb-1">pH: 5.2 <span class="status-badge status-critical">Critical</span></p>
                                <small class="text-muted">Last tested: Mar 10, 2024</small>
                            </div>
                            <div class="text-end">
                                <i class="fas fa-exclamation-circle text-danger fa-2x"></i>
                            </div>
                        </div>
                        <div class="ph-meter">
                            <div class="ph-indicator" style="left: 15%;"></div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <button class="quick-action-btn btn-danger">
                                    <i class="fas fa-bolt"></i> Urgent Action Required
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div class="ph-card">
                        <h6><i class="fas fa-chart-bar"></i> Farm Summary</h6>
                        <div class="row text-center">
                            <div class="col-4">
                                <div class="h5 text-success">3</div>
                                <small>Fields Monitored</small>
                            </div>
                            <div class="col-4">
                                <div class="h5 text-warning">1</div>
                                <small>Need Attention</small>
                            </div>
                            <div class="col-4">
                                <div class="h5 text-primary">6.1</div>
                                <small>Avg pH</small>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Alerts -->
                    <div class="ph-card">
                        <h6><i class="fas fa-bell"></i> Recent Alerts</h6>
                        <div class="alert-item">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <strong>East Field pH Critical</strong>
                                    <br><small>pH dropped to 5.2 - immediate lime application recommended</small>
                                </div>
                                <small class="text-muted">2h ago</small>
                            </div>
                        </div>
                        <div class="alert-item">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <strong>North Field Test Due</strong>
                                    <br><small>Annual pH test scheduled for this week</small>
                                </div>
                                <small class="text-muted">1d ago</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- pH Test Tab -->
                <div class="tab-pane fade" id="test" role="tabpanel">
                    <div class="ph-card">
                        <h6><i class="fas fa-vial"></i> Record pH Test</h6>
                        
                        <!-- GPS Location -->
                        <div class="gps-info">
                            <i class="fas fa-map-marker-alt"></i> 
                            <span id="gpsLocation">Getting location...</span>
                            <button class="btn btn-sm btn-outline-primary float-end" onclick="getLocation()">
                                <i class="fas fa-crosshairs"></i>
                            </button>
                        </div>

                        <form id="phTestForm">
                            <div class="input-group-mobile">
                                <label for="fieldSelect">Field</label>
                                <select class="form-control" id="fieldSelect" required>
                                    <option value="">Select Field</option>
                                    <option value="north_field">North Field</option>
                                    <option value="south_field">South Field</option>
                                    <option value="east_field">East Field</option>
                                    <option value="west_field">West Field</option>
                                </select>
                            </div>

                            <div class="input-group-mobile">
                                <label for="phValue">pH Value</label>
                                <input type="number" class="form-control" id="phValue" 
                                       step="0.1" min="3.0" max="10.0" required
                                       placeholder="e.g., 6.2">
                            </div>

                            <div class="input-group-mobile">
                                <label for="bufferPh">Buffer pH (optional)</label>
                                <input type="number" class="form-control" id="bufferPh" 
                                       step="0.1" min="4.0" max="7.5"
                                       placeholder="e.g., 6.8">
                            </div>

                            <div class="input-group-mobile">
                                <label for="testMethod">Test Method</label>
                                <select class="form-control" id="testMethod">
                                    <option value="soil_probe">Soil Probe</option>
                                    <option value="test_strips">Test Strips</option>
                                    <option value="laboratory">Laboratory</option>
                                    <option value="digital_meter">Digital Meter</option>
                                </select>
                            </div>

                            <div class="input-group-mobile">
                                <label for="labName">Lab Name (if applicable)</label>
                                <input type="text" class="form-control" id="labName" 
                                       placeholder="e.g., AgriTest Labs">
                            </div>

                            <div class="input-group-mobile">
                                <label for="testNotes">Notes</label>
                                <textarea class="form-control" id="testNotes" rows="3" 
                                          placeholder="Additional observations..."></textarea>
                            </div>

                            <div class="input-group-mobile">
                                <label>Photo Documentation</label>
                                <input type="file" class="form-control" accept="image/*" capture="camera">
                                <small class="text-muted">Take photo of test results or soil conditions</small>
                            </div>

                            <button type="submit" class="quick-action-btn">
                                <i class="fas fa-save"></i> Save pH Test
                            </button>
                        </form>
                    </div>

                    <!-- Quick pH Reference -->
                    <div class="ph-card">
                        <h6><i class="fas fa-info-circle"></i> pH Reference Guide</h6>
                        <div class="row">
                            <div class="col-6">
                                <strong>Acidic (< 6.0)</strong>
                                <ul class="small">
                                    <li>Aluminum toxicity risk</li>
                                    <li>Poor phosphorus availability</li>
                                    <li>Reduced microbial activity</li>
                                </ul>
                            </div>
                            <div class="col-6">
                                <strong>Alkaline (> 7.5)</strong>
                                <ul class="small">
                                    <li>Iron deficiency risk</li>
                                    <li>Zinc deficiency risk</li>
                                    <li>Phosphorus fixation</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lime Calculator Tab -->
                <div class="tab-pane fade" id="lime" role="tabpanel">
                    <div class="ph-card">
                        <h6><i class="fas fa-calculator"></i> Lime Calculator</h6>
                        
                        <form id="limeCalculatorForm">
                            <div class="input-group-mobile">
                                <label for="currentPh">Current pH</label>
                                <input type="number" class="form-control" id="currentPh" 
                                       step="0.1" min="3.0" max="10.0" required
                                       placeholder="e.g., 5.8">
                            </div>

                            <div class="input-group-mobile">
                                <label for="targetPh">Target pH</label>
                                <input type="number" class="form-control" id="targetPh" 
                                       step="0.1" min="3.0" max="10.0" required
                                       placeholder="e.g., 6.5">
                            </div>

                            <div class="input-group-mobile">
                                <label for="soilTexture">Soil Texture</label>
                                <select class="form-control" id="soilTexture" required>
                                    <option value="">Select Texture</option>
                                    <option value="sand">Sand</option>
                                    <option value="loamy_sand">Loamy Sand</option>
                                    <option value="sandy_loam">Sandy Loam</option>
                                    <option value="loam">Loam</option>
                                    <option value="silt_loam">Silt Loam</option>
                                    <option value="clay_loam">Clay Loam</option>
                                    <option value="clay">Clay</option>
                                </select>
                            </div>

                            <div class="input-group-mobile">
                                <label for="organicMatter">Organic Matter (%)</label>
                                <input type="number" class="form-control" id="organicMatter" 
                                       step="0.1" min="0" max="15" required
                                       placeholder="e.g., 3.2">
                            </div>

                            <div class="input-group-mobile">
                                <label for="fieldSize">Field Size (acres)</label>
                                <input type="number" class="form-control" id="fieldSize" 
                                       step="0.1" min="0.1" required
                                       placeholder="e.g., 25.5">
                            </div>

                            <button type="submit" class="quick-action-btn">
                                <i class="fas fa-calculator"></i> Calculate Lime Requirement
                            </button>
                        </form>
                    </div>

                    <!-- Lime Recommendations -->
                    <div id="limeRecommendations" style="display: none;">
                        <div class="lime-recommendation">
                            <h6><i class="fas fa-leaf"></i> Agricultural Limestone</h6>
                            <div class="row">
                                <div class="col-6">
                                    <strong>Rate:</strong> <span id="agLimeRate">2.5 tons/acre</span>
                                </div>
                                <div class="col-6">
                                    <strong>Cost:</strong> <span id="agLimeCost">$112.50/acre</span>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-6">
                                    <strong>Timing:</strong> Fall application
                                </div>
                                <div class="col-6">
                                    <strong>Effect:</strong> 6-12 months
                                </div>
                            </div>
                            <div class="mt-2">
                                <small><strong>Notes:</strong> Most economical option, slow but long-lasting effect</small>
                            </div>
                        </div>

                        <div class="lime-recommendation">
                            <h6><i class="fas fa-bolt"></i> Hydrated Lime</h6>
                            <div class="row">
                                <div class="col-6">
                                    <strong>Rate:</strong> <span id="hydratedLimeRate">1.8 tons/acre</span>
                                </div>
                                <div class="col-6">
                                    <strong>Cost:</strong> <span id="hydratedLimeCost">$153.00/acre</span>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-6">
                                    <strong>Timing:</strong> Spring application
                                </div>
                                <div class="col-6">
                                    <strong>Effect:</strong> 1-3 months
                                </div>
                            </div>
                            <div class="mt-2">
                                <small><strong>Notes:</strong> Fast-acting but more expensive, good for emergency correction</small>
                            </div>
                        </div>
                    </div>

                    <!-- Application Tips -->
                    <div class="ph-card">
                        <h6><i class="fas fa-lightbulb"></i> Application Tips</h6>
                        <ul class="small mb-0">
                            <li>Apply lime when soil moisture is adequate</li>
                            <li>Incorporate within 2 weeks for best results</li>
                            <li>Avoid application before heavy rain</li>
                            <li>Consider split applications for high rates</li>
                            <li>Retest pH 12-18 months after application</li>
                        </ul>
                    </div>
                </div>

                <!-- Monitoring Tab -->
                <div class="tab-pane fade" id="monitor" role="tabpanel">
                    <!-- pH Trends Chart -->
                    <div class="trend-chart">
                        <h6><i class="fas fa-chart-line"></i> pH Trends - North Field</h6>
                        <canvas id="phTrendChart" width="300" height="150"></canvas>
                    </div>

                    <!-- Monitoring Schedule -->
                    <div class="ph-card">
                        <h6><i class="fas fa-calendar-alt"></i> Monitoring Schedule</h6>
                        <div class="list-group list-group-flush">
                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>North Field</strong>
                                    <br><small>Annual pH test</small>
                                </div>
                                <span class="badge bg-warning">Due Apr 15</span>
                            </div>
                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>South Field</strong>
                                    <br><small>Post-lime monitoring</small>
                                </div>
                                <span class="badge bg-info">Due May 1</span>
                            </div>
                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>East Field</strong>
                                    <br><small>Critical follow-up</small>
                                </div>
                                <span class="badge bg-danger">Overdue</span>
                            </div>
                        </div>
                    </div>

                    <!-- Alert Configuration -->
                    <div class="ph-card">
                        <h6><i class="fas fa-bell"></i> Alert Settings</h6>
                        <form id="alertSettingsForm">
                            <div class="input-group-mobile">
                                <label for="criticalLow">Critical Low pH</label>
                                <input type="number" class="form-control" id="criticalLow" 
                                       step="0.1" value="5.0" placeholder="5.0">
                            </div>
                            <div class="input-group-mobile">
                                <label for="criticalHigh">Critical High pH</label>
                                <input type="number" class="form-control" id="criticalHigh" 
                                       step="0.1" value="8.0" placeholder="8.0">
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="emailAlerts" checked>
                                <label class="form-check-label" for="emailAlerts">
                                    Email alerts
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="smsAlerts">
                                <label class="form-check-label" for="smsAlerts">
                                    SMS alerts
                                </label>
                            </div>
                            <button type="submit" class="quick-action-btn mt-2">
                                <i class="fas fa-save"></i> Save Alert Settings
                            </button>
                        </form>
                    </div>

                    <!-- Historical Data -->
                    <div class="ph-card">
                        <h6><i class="fas fa-history"></i> Recent Tests</h6>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Field</th>
                                        <th>pH</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>North</td>
                                        <td>5.8</td>
                                        <td>Mar 15</td>
                                        <td><span class="status-badge status-warning">Low</span></td>
                                    </tr>
                                    <tr>
                                        <td>South</td>
                                        <td>6.5</td>
                                        <td>Feb 28</td>
                                        <td><span class="status-badge status-good">Good</span></td>
                                    </tr>
                                    <tr>
                                        <td>East</td>
                                        <td>5.2</td>
                                        <td>Mar 10</td>
                                        <td><span class="status-badge status-critical">Critical</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        // GPS Location
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                document.getElementById("gpsLocation").innerHTML = "Geolocation not supported";
            }
        }

        function showPosition(position) {
            const lat = position.coords.latitude.toFixed(6);
            const lon = position.coords.longitude.toFixed(6);
            document.getElementById("gpsLocation").innerHTML = `${lat}, ${lon}`;
        }

        function showError(error) {
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    document.getElementById("gpsLocation").innerHTML = "Location access denied";
                    break;
                case error.POSITION_UNAVAILABLE:
                    document.getElementById("gpsLocation").innerHTML = "Location unavailable";
                    break;
                case error.TIMEOUT:
                    document.getElementById("gpsLocation").innerHTML = "Location timeout";
                    break;
                default:
                    document.getElementById("gpsLocation").innerHTML = "Location error";
                    break;
            }
        }

        // Initialize GPS on load
        window.onload = function() {
            getLocation();
            initializeTrendChart();
        };

        // pH Test Form
        document.getElementById('phTestForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                field: document.getElementById('fieldSelect').value,
                ph: document.getElementById('phValue').value,
                bufferPh: document.getElementById('bufferPh').value,
                method: document.getElementById('testMethod').value,
                lab: document.getElementById('labName').value,
                notes: document.getElementById('testNotes').value,
                location: document.getElementById('gpsLocation').innerHTML,
                timestamp: new Date().toISOString()
            };
            
            // Here you would send to API
            console.log('pH Test Data:', formData);
            
            alert('pH test recorded successfully!');
            this.reset();
        });

        // Lime Calculator Form
        document.getElementById('limeCalculatorForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const currentPh = parseFloat(document.getElementById('currentPh').value);
            const targetPh = parseFloat(document.getElementById('targetPh').value);
            const fieldSize = parseFloat(document.getElementById('fieldSize').value);
            
            // Simple lime calculation (would use API in real implementation)
            const phDifference = targetPh - currentPh;
            const limeRate = Math.max(0, phDifference * 2.0); // Simplified calculation
            const agLimeCost = limeRate * 45; // $45/ton
            const hydratedRate = limeRate * 0.75;
            const hydratedCost = hydratedRate * 85; // $85/ton
            
            // Update recommendations
            document.getElementById('agLimeRate').textContent = `${limeRate.toFixed(1)} tons/acre`;
            document.getElementById('agLimeCost').textContent = `$${agLimeCost.toFixed(2)}/acre`;
            document.getElementById('hydratedLimeRate').textContent = `${hydratedRate.toFixed(1)} tons/acre`;
            document.getElementById('hydratedLimeCost').textContent = `$${hydratedCost.toFixed(2)}/acre`;
            
            document.getElementById('limeRecommendations').style.display = 'block';
        });

        // Alert Settings Form
        document.getElementById('alertSettingsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const settings = {
                criticalLow: document.getElementById('criticalLow').value,
                criticalHigh: document.getElementById('criticalHigh').value,
                emailAlerts: document.getElementById('emailAlerts').checked,
                smsAlerts: document.getElementById('smsAlerts').checked
            };
            
            console.log('Alert Settings:', settings);
            alert('Alert settings saved successfully!');
        });

        // Initialize pH Trend Chart
        function initializeTrendChart() {
            const ctx = document.getElementById('phTrendChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'pH Level',
                        data: [6.2, 6.1, 5.9, 5.8, 5.8, 5.9],
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 5.0,
                            max: 7.0,
                            ticks: {
                                stepSize: 0.2
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Offline Support
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(registration => console.log('SW registered'))
                .catch(error => console.log('SW registration failed'));
        }

        // Store data locally when offline
        function storeOfflineData(data) {
            const offlineData = JSON.parse(localStorage.getItem('phOfflineData') || '[]');
            offlineData.push({...data, offline: true, timestamp: Date.now()});
            localStorage.setItem('phOfflineData', JSON.stringify(offlineData));
        }

        // Sync offline data when online
        function syncOfflineData() {
            const offlineData = JSON.parse(localStorage.getItem('phOfflineData') || '[]');
            if (offlineData.length > 0 && navigator.onLine) {
                // Send to API
                console.log('Syncing offline data:', offlineData);
                localStorage.removeItem('phOfflineData');
            }
        }

        // Check online status
        window.addEventListener('online', syncOfflineData);
        window.addEventListener('offline', () => {
            console.log('App is offline - data will be stored locally');
        });
    </script>
</body>
</html>